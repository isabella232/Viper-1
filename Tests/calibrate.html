<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <script type="text/javascript" src="../DfxJSLib/dfx.js"></script>
        <script type="text/javascript" src="./test.js"></script>
        <script type="text/javascript" src="./PHPSikuli/PHPSikuliBrowser.js"></script>
        <script type="text/javascript" src="../Viper-all.js"></script>
        <link rel="stylesheet" media="screen" href="./test.css" />
        <!--[if IE]>
            <link rel="stylesheet" type="text/css" href="./test-ie.css" />
        <![endif]-->
        <script>
            function getCoords(status, className)
            {
                var coords  = {};
                var buttons = ViperUtil.getClass('Viper-button', ViperUtil.getid('__buttons'));
                for (var i = 0; i < buttons.length; i++) {
                    buttons[i].className = 'Viper-button ' + className;
                    var dim  = ViperUtil.getBoundingRectangle(buttons[i]);
                    coords[buttons[i].id + status] = {
                        x1: parseInt(dim.x1 + 2),
                        y1: parseInt(dim.y1 + 2),
                        x2: parseInt(dim.x2 - 1),
                        y2: parseInt(dim.y2 - 1)
                    };
                }

                return coords;

            }

            function showAllBtns()
            {
                var classNames = ['Viper-dummyClass', 'Viper-selected', 'Viper-active', 'Viper-disabled'];
                var buttonsContainer = ViperUtil.getid('__buttons');

                ViperUtil.remove(buttonsContainer);
                ViperUtil.remove(ViperUtil.getid('content'));
                ViperUtil.remove(ViperUtil.getid('__textFields'));

                var allBtns = document.createElement('div');
                allBtns.id  = '__allBtns';

                for (var i = 0; i < classNames.length; i++) {
                    var className = classNames[i];
                    var clone     = buttonsContainer.cloneNode(true);
                    clone.removeAttribute('id');
                    var buttons = ViperUtil.getClass('Viper-button', clone);
                    for (var j = 0; j < buttons.length; j++) {
                        buttons[j].className = 'Viper-button ' + className;
                    }

                    allBtns.appendChild(clone);
                }

                ViperUtil.insertBefore(menu, allBtns);

            }

            function getVITP(orientation)
            {
                var elem   = ViperUtil.getClass('ViperITP Viper-themeDark Viper-scalable Viper-visible')[0];

                if (orientation === 'left') {
                    ViperUtil.addClass(elem, 'Viper-orientationLeft');
                } else if (orientation === 'right') {
                    ViperUtil.addClass(elem, 'Viper-orientationRight');
                }

                var vitp   = {};
                var coords = ViperUtil.getElementCoords(elem);
                var width  = parseInt(ViperUtil.getStyle(elem, 'width').replace('px', ''));
                if (orientation) {
                    vitp = {
                        x: parseInt(coords.x),
                        y: parseInt(coords.y),
                        width: width
                    };
                } else {
                    vitp = {
                        x: parseInt(coords.x + (width / 2)),
                        y: parseInt(coords.y),
                        width: width
                    };
                }

                return vitp;
            }

            var viper = null;
            ViperReadyCallback = function() {
                var contentElement = ViperUtil.getid('content');
                viper = new Viper('test');
                viper.getPluginManager().setPlugins(['ViperCoreStylesPlugin', 'ViperKeyboardEditorPlugin', 'ViperInlineToolbarPlugin', 'ViperHistoryPlugin', 'ViperListPlugin', 'ViperFormatPlugin', 'ViperToolbarPlugin', 'ViperTableEditorPlugin', 'ViperCopyPastePlugin', 'ViperImagePlugin', 'ViperLinkPlugin', 'ViperAccessibilityPlugin', 'ViperSourceViewPlugin', 'ViperSearchReplacePlugin', 'ViperLangToolsPlugin', 'ViperCharMapPlugin', 'ViperTrackChangesPlugin']);
                viper.setEditableElement(contentElement);
            };
        </script>
    </head>
    <body spellcheck="false">
        <img id="windowTarget" src="./Core/Images/window-target.png"/>
        <div id="__buttons">__TEST_CONTENT__</div>
        <div id="__allButtons"></div>
        <br /><div id="content" class="__calibrate-image">__&nbsp;&nbsp;XAX</div>
        <br />
        <div id="__textFields" style="font-size: 9px; width: 200px;">
            <div class="Viper-textbox Viper-focused Viper-actionClear">
                <label class="Viper-textbox-label">
                    <div class="Viper-textbox-main" style="padding-left: 73px;">
                        <span class="Viper-textbox-title">Textbox</span>
                        <input type="text" class="Viper-textbox-input" />
                        <span id="textboxActionClear" class="Viper-textbox-action"></span>
                    </div>
                </label>
            </div>
            <div class="Viper-textbox Viper-focused Viper-actionRevert">
                <label class="Viper-textbox-label">
                    <div class="Viper-textbox-main" style="padding-left: 73px;">
                        <span class="Viper-textbox-title">Textbox</span>
                        <input type="text" class="Viper-textbox-input" />
                        <span id="textboxActionRevert" class="Viper-textbox-action"></span>
                    </div>
                </label>
            </div>
        </div>
        <div id="menu"></div>
    </body>
</html>
